/******************************************************************
 * This is the main file for the Software Sessions
 *
 */

#include <stdint.h>
#include <inttypes.h>
#include <math.h>

#include "common.h"

// Uncomment for Session SW1
// extern void warmup();

// Uncomment for Session SW2 onwards
//#include "mp_arith.h"
//#include "montgomery.h"
//#include "asm_func.h"


int main()
{
    init_platform();
    init_performance_counters(1);

    // Hello World template
    //----------------------
    xil_printf("Begin\n\r");
    uint32_t a[32]         = { 0x222e8a8f, 0x810a8202, 0x3ce89c16, 0x7c8b2da1, 0x214624db, 0x407c77d7, 0x65fdb66e, 0xecacf104, 0xf4cc7356, 0x40bdbfd7, 0xbd10a3ea, 0x55e07e26, 0x7d8e6016, 0xbeb8ca61, 0x545f981c, 0x4fa0fb49, 0x75d1f88d, 0x107cad15, 0x7166db60, 0x874cad8a, 0x1b3e5d4b, 0x44c213b9, 0xe1384827, 0x9dd95ed8, 0xb3889e6a, 0xa4ca2f4a, 0x835d5781, 0x31bc3a37, 0x84b55853, 0x7d1f5e23, 0xf6b1838f, 0x98bf5e5e };
    uint32_t b[32]         = { 0x67e47e3c, 0x07adbfd4, 0x110bdd5b, 0x0d7803f2, 0xbbad2e2a, 0xfc71e15e, 0xb54968e7, 0xabc270a0, 0x0f48ed7a, 0x02c2876d, 0xf35a434d, 0xf79522c6, 0xae653700, 0xbc8c99bb, 0x6e2bf205, 0x3e09e51b, 0xbccff9a1, 0x6f1da9b2, 0x0936a448, 0x0163d155, 0xcbc8ce9a, 0x4df63edf, 0xff9bf394, 0x6215457d, 0xa173a795, 0xb01af73a, 0xf7418a4d, 0x25b1f5b3, 0x6f67ffff, 0x6cf28757, 0xa9bacaca, 0x9ef48c97 };
    uint32_t n[32]         = { 0x7be27301, 0xcf753be0, 0x7e1ff69f, 0xa6a56faf, 0x8fe319d5, 0x75968442, 0x64a982ad, 0x146e959d, 0x7ac28727, 0xbc57f003, 0xcf2178f0, 0x7394e6ff, 0x4d8e059a, 0x488296c0, 0x225fc45a, 0x781a8909, 0xb94f9751, 0x66f08a12, 0xae6aa880, 0x4bb954cf, 0xcce4974b, 0x5039b2fb, 0x73a80fad, 0xa8acdfaf, 0x00d8431c, 0x03459733, 0xcf6bd6a5, 0xdc61f6b4, 0x637f7fcf, 0xddca8251, 0x02cc548f, 0xa830bb48 };
    uint32_t n_prime[32]   = { 0x273972ff, 0xd7d58449, 0x915aa751, 0x95598660, 0x332c2b9c, 0x91946788, 0x19e5beb0, 0x294ef430, 0xb000b325, 0xa0e27a34, 0xbe1abc1b, 0xa62f816c, 0x06787010, 0x72f75946, 0x14e9e2e7, 0x53f56280, 0x69fe6671, 0xe84dab55, 0x6d7353da, 0xac8b0f14, 0xcb894496, 0x81cf3c11, 0x6c3fe40a, 0x25dbc7fe, 0xd685da7a, 0x283bf07d, 0xf8a05a34, 0x60caebd2, 0x62c3507c, 0xd286ffff, 0x2b99d11d, 0x43b758cc };

    uint32_t res[33] = {0};
    xil_printf("Hello World!\n\r");

START_TIMING;
	//montMul(a,b,n,n_prime,res,32);
    montMulOpt(a,b,n,n_prime,res,32);

STOP_TIMING;

	xil_printf("\n\n");
	int length = sizeof(res) / sizeof(res[0]);
	customprint(res, length);

	xil_printf("End\n\r");

    // SW1: warmup exercise
    //----------------------
    // warmup();

    cleanup_platform();

    return 0;
}
